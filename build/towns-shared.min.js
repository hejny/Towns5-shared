var PRS$0=function(t,e){return t.__proto__={a:e},t.a===e}({},{}),DP$0=Object.defineProperty,GOPD$0=Object.getOwnPropertyDescriptor,MIXIN$0=function(t,e){for(var r in e)e.hasOwnProperty(r)&&DP$0(t,r,GOPD$0(e,r));return t},SP$0=Object.setPrototypeOf||function(t,e){return PRS$0?t.__proto__=e:DP$0(t,"__proto__",{value:e,configurable:!0,enumerable:!1,writable:!0}),t},OC$0=Object.create;global.Towns={},module.exports=global.Towns;var T=global.Towns;T.setNamespace=function(t){t=t.split(".");for(var e,r=this,i=0,n=t.length;n>i;i++){if(e=t[i],"T"===e)throw new Error("Cant set namespace T under T!");"undefined"==typeof r[e]?(r[e]={},r=r[e]):r=r[e]}return!0},T.ArrayFunctions=function(){"use strict";function t(){}DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1});var e={};return e.id2i=function(t,e){for(var r in t)if(t[r].id==e)return r;return-1},e.id2item=function(t,e){var r=arguments[2];void 0===r&&(r=!1);for(var i in t)if(t[i].id==e)return t[i];if(r)throw new Error(r);return null},e.idRemove=function(t,e){for(var r in t)if(t[r].id==e)return t.splice(r,1),!0;return!1},e.iterate2D=function(t,e){for(var r=0,i=t.length;i>r;r++)for(var n=0,o=t[r].length;o>n;n++)e(r,n)},e.removeItems=function(t,e,r){var i=t.slice((r||e)+1||t.length);return t.length=0>e?t.length+e:e,t.push.apply(t,i)},e.filterPath=function(t,e,i){if(!is(t))throw new Error("filterPath: Object is undefined.");if(!is(e.forEach))throw r(e),new Error("filterPath: T.Path is not correct array.");for(var n in e){var o=e[n];if(!(n<e.length-1||"undefined"==typeof i))return t[o]=i,!0;if("undefined"==typeof t[o])return;t=t[o]}return t},e.unique=function(t){for(var e={},r=[],i=0;i<t.length;i++)e[t[i]]||(e[t[i]]=t,r.push(t[i]));return r},e.array2table=function(t){var e=arguments[1];void 0===e&&(e="");var r="",i=t.length,n=t[0].length;r+='<table class="'+e+'">';for(var o=0;i>o;o++){r+="<tr>";for(var a=t[o].length,s=n-a,u=0;a>u;u++)r+=u==a-1&&0!==s?'<td colspan="'+(s+1)+'">':"<td>",r+=t[o][u],r+="</td>";r+="</tr>"}return r+="</table>"},MIXIN$0(t,e),e=void 0,t}(),T.Color=function(){"use strict";function t(t,e,r){var i=arguments[3];void 0===i&&(i=255),this.r=t,this.g=e,this.b=r,this.a=i}var e={},r={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),r.bounds=function(){this.r=Math.round(this.r),this.g=Math.round(this.g),this.b=Math.round(this.b),this.a=Math.round(this.a),this.r>255&&(this.r=255),this.r<0&&(this.r=0),this.g>255&&(this.g=255),this.g<0&&(this.g=0),this.b>255&&(this.b=255),this.b<0&&(this.b=0),this.a>255&&(this.a=255),this.a<0&&(this.a=0)},r.getCssColor=function(){return this.bounds(),255==this.a?"rgb("+this.r+", "+this.g+", "+this.b+")":"rgba("+this.r+", "+this.g+", "+this.b+", "+Math.round(this.a/255*100)/100+")"},r.getHex=function(){return this.bounds(),"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1)},e.createFromHex=function(t){var e,r;if(r=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,t=t.replace(r,function(t,e,r,i){return e+e+r+r+i+i}),e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t))return new T.Color(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16));throw new Error("Error while creating T.Color from "+t)},MIXIN$0(t,e),MIXIN$0(t.prototype,r),e=r=void 0,t}(),T.Game=function(){"use strict";function t(t,e,r){this.action_type_list=t,this.max_life_modifier=e,this.price_key_modifier=r}var e={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),e.getObjectPriceBases=function(t){var e=this,r=[];return"undefined"==typeof t.actions?[]:(t.actions.forEach(function(t){if("undefined"==typeof e.action_type_list[t.type])throw new Error("Unknown action type "+t.type);var i=e.action_type_list[t.type];for(var n in i.params){var o=i.params[n];if(typeof t.params[n]!=o)throw new Error("Param "+n+" should be "+o+" in action "+t.type)}var a=Math.ceil(i.price_base(t.params));if(0>a)throw new Error("Params in action "+t.type+" should not make this action negative");r.push(a)}),r)},e.getObjectMaxLife=function(t){var e=this.getObjectPriceBases(t),r=e.reduce(function(t,e){return t+e},0);return r=this.max_life_modifier(r)},e.getObjectPrices=function(t){var e=this.getObjectPriceBases(t),r=this,i=[];if("undefined"==typeof t.actions)return[];var n=r.getObjectDesignPrice(t);return t.actions.forEach(function(t,o){var a=r.action_type_list[t.type];a.price_resources_list.sort(function(t,e){return n.compare(t.clone().signum())-n.compare(e.clone().signum())});var s=a.price_resources_list[0].clone();s.multiply(e[o]),i.push(s)}),i},e.getObjectPrice=function(t){var e=new T.Resources({}),r=this.getObjectPrices(t);return r.forEach(function(t){e.add(t)}),e.apply(this.price_key_modifier),e},e.getObjectDesignPrice=function(t){if(!t.hasOwnProperty("design"))throw new Error("Object should have design!");if("model"!=t.design.type)throw new Error("Object should have design of type model!");var e=new T.Resources({}),r=new T.Model(t.design.data),i=r.getLinearParticles();return i.forEach(function(t){var r=t.size.x*t.size.y*t.size.z,i=t.material.split("_");i=i[0];var n={};n[i]=r,e.add(n)}),e},MIXIN$0(t.prototype,e),e=void 0,t}(),T.Game.ActionType=function(){"use strict";function t(t,e,r,i,n){this.type=t,this.params=e,this.price_base=r,this.price_resources_list=i,this.perform=n}return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t}(),T.MapGenerator=function(){"use strict";function t(t,e,r,i){this.getZ=t,this.z_normalizing_table=e,this.biotope=r,this.virtualObjectGenerator=i}var e={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),e.getZMapCircle=function(t,e){for(var r=[],i=0;2*e>=i;i++){r[i]=[];for(var n=0;2*e>=n;n++)if(!(Math.pow(n-e+.5,2)+Math.pow(i-e+.5,2)>Math.pow(e,2))){var o=this.getZ(n-e+t.x,i-e+t.y);r[i][n]=this.z_normalizing_table[Math.floor(o*this.z_normalizing_table.length)]}}return r},e.terrainMap=function(t){for(var e=[],r=0,i=t.length;i>r;r++){e[r]=[];for(var n=0;i>n;n++)"undefined"!=typeof t[r][n]&&(e[r][n]=this.biotope.getZTerrain(t[r][n]))}return e},e.getMapArrayCircle=function(t,e){var r=this.getZMapCircle(t,e),i=this.terrainMap(r);return i},e.convertMapArrayToObjects=function(t,e,r){for(var i=new T.Objects.Array,n=0;2*r>n;n++)for(var o=0;2*r>o;o++)if("undefined"!=typeof t[n][o]){var a=new T.Objects.Terrain(t[n][o]);a.x=e.x-r+o,a.y=e.y-r+n,i.push(a)}return i},e.getPureMap=function(t,e){var r=arguments[2];void 0===r&&(r=!1);var i={x:Math.floor(t.x),y:Math.floor(t.y)};r&&(r={x:r.x-i.x,y:r.y-i.y});var n,o,a,s,u,c=new T.Objects.Array;for(o=0;2*e>=o;o++)for(n=0;2*e>=n;n++)Math.pow(n-e+.5,2)+Math.pow(o-e+.5,2)>Math.pow(e,2)||r&&Math.pow(n-r.x-e+.5,2)+Math.pow(o-r.y-e+.5,2)<=Math.pow(e,2)||(a=this.getZ(n-e+i.x,o-e+i.y),a=this.z_normalizing_table[Math.floor(a*this.z_normalizing_table.length)],s=this.biotope.getZTerrain(a),u=new T.Objects.Terrain(s),u.x=i.x-e+n,u.y=i.y-e+o,c.push(u));return c},e.getVirtualObjectsFromTerrainObjects=function(t){for(var e=[],r=t.get1x1TerrainObjects().getAll(),i=0,n=r.length;n>i;i++)this.virtualObjectGenerator(r[i],e);return e},e.getCompleteObjects=function(t,e,r){var i=arguments[3];void 0===i&&(i=!0);var n=arguments[4];void 0===n&&(n=!1);var o=this.getPureMap(e,r,n);if(t.forEach(function(t){o.push(t)}),i){var a=this.getVirtualObjectsFromTerrainObjects(o);a.forEach(function(t){o.push(t)})}return o},MIXIN$0(t.prototype,e),e=void 0,t}(),T.MapGenerator.Biotope=function(){"use strict";function t(t){var e=0;t.forEach(function(t){e+=t.amount});var r=0;t.forEach(function(t){t.from=r/e,r+=t.amount}),this.terrains=t}var e={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),e.getZTerrain=function(t){for(var e=this.terrains.length-1;e>=0;e--)if(t>=this.terrains[e].from)return this.terrains[e].terrain},MIXIN$0(t.prototype,e),e=void 0,t}(),T.Math=function(){"use strict";function t(){}DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1});var e={};return e.sign=function(t){return t=+t,0===t||isNaN(t)?t:t>0?1:-1},e.baseLog=function(t,e){return Math.log(e)/Math.log(t)},e.prettyNumber=function(t,e){e=e||2;var r=Math.ceil(T.Math.baseLog(10,t)),i=Math.pow(10,e-r);return t*=i,t=Math.round(t),t/=i},e.angleDiff=function(t,e){var r=t-e;return r=(r+180)%360-180},e.rad2deg=function(t){return t*(180/Math.PI)},e.deg2rad=function(t){return t*(Math.PI/180)},e.xy2dist=function(t,e){return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))},e.xy2distDeg=function(t,e){var r={};return r.dist=this.xy2dist(t,e),r.deg=this.rad2deg(Math.atan2(e,t)),r},e.distDeg2xy=function(t,e){var r=this.deg2rad(e),i={};return i.x=Math.cos(r)*t,i.y=Math.sin(r)*t,i},e.xyRotate=function(t,e,r){var i=this.xy2dist(t,e),n=Math.atan2(e,t);n+=this.deg2rad(r);var o={};return o.x=Math.cos(n)*i,o.y=Math.sin(n)*i,o},e.randomSeedPosition=function(t,e){return(Math.sin(Math.pow(e.x*e.y-t,2))+1)/2},e.toFloat=function(t,e){return"undefined"==typeof e&&(e=0),"undefined"==typeof t?e:(t=parseFloat(t),isNaN(t)?e:t)},e.toInt=function(t,e){return"undefined"==typeof t?e:(t=parseInt(t),isNaN(t)?e:t)},e.bounds=function(t,e,r){return e>t?e:t>r?r:t},e.lineCollision=function(t,e,r,i,n,o,a,s){var u,c=(r-t)*(s-o)-(i-e)*(a-n),h=(e-o)*(a-n)-(t-n)*(s-o),f=(e-o)*(r-t)-(t-n)*(i-e);if(0===c)u=!1;else{var p=h/c,l=f/c;u=p>=0&&1>=p&&l>=0&&1>=l}return u},e.blurXY=function(t,e){return function(r,i){var n,o,a=0,s=0;for(n=r-e;r+e>=n;n++)for(o=i-e;i+e>=o;o++)Math.pow(e,2)<Math.pow(n-r,2)+Math.pow(o-i,2)||(a+=t(n,o),s++);return a/s}},e.bytesToSize=function(t){var e=["Bytes","KB","MB","GB","TB"];if(0===t)return"0 Byte";var r=parseInt(Math.floor(Math.log(t)/Math.log(1024)));return Math.round(t/Math.pow(1024,r),2)+" "+e[r]},e.proportions=function(t,e,r,i,n){var o=r-t,a=n-i,s=r-e,u=a*s/o;return n-u},MIXIN$0(t,e),e=void 0,t}(),T.Model=function(){"use strict";function t(t){return"undefined"==typeof t?!1:(this.name=t.name,this.particles=t.particles,this.rotation=t.rotation,this.size=t.size,"undefined"==typeof this.rotation&&(this.rotation=0),void("undefined"==typeof this.size&&(this.size=1)))}var e={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),e.clone=function(){return new T.Model(JSON.parse(JSON.stringify(this)))},e.addRotationSize=function(t,e){"undefined"==typeof t&&(t=0),"undefined"==typeof e&&(e=1),this.rotation+=t,this.size=this.size*e},e.range=function(t){if("xy"==t)return T.Math.xy2dist(this.range("x"),this.range("y")*this.size);var e,r,i=this.getLinearParticles(),n=!1,o=!1;for(var a in i)r=i[a].position[t],e=i[a].position[t]+i[a].size[t],n===!1&&(n=e),o===!1&&(o=r),e>n&&(n=e),o>r&&(o=r);return Math.abs(o-n)},e.moveBy=function(t,e,r){"undefined"==typeof t&&(t=0),"undefined"==typeof e&&(e=0),"undefined"==typeof r&&(r=0);for(var i in this.particles)this.particles[i].position.x+=t,this.particles[i].position.y+=e,this.particles[i].position.z+=r},e.joinModelZ=function(t,e,i){var n=this.getLinearParticles(),o=t.getLinearParticles(),a=[0];for(var s in o){o[s].position.x+=e,o[s].position.y+=i;for(var u in n)Particles.collision2D(n[u],o[s])&&(r(n[u],o[s]),a.push(n[u].position.z+n[u].size.z))}var c=Math.max.apply(Math,a);return c},e.joinModel=function(t,e,r){var i=this.joinModelZ(t,e,r);this.particles=[JSON.parse(JSON.stringify(this)),JSON.parse(JSON.stringify(t))],this.particles[1].position={x:e,y:r,z:i},this.rotation=0,this.size=1},e.getDeepCopyWithoutLinks=function(){var t=this.clone(),e=function(t,r){for(var i in t){if(t[i].name==r)return t[i];if("undefined"!=typeof t[i].particles){var n=e(t[i].particles,r);if(n!==!1)return n}}return!1},r=function(i){for(var n in i){if("undefined"!=typeof i[n].link){var o=e(t.particles,i[n].link);if(o===!1)throw new Error("Invalid link "+particle.link);o=JSON.parse(JSON.stringify(o)),"undefined"!=typeof i[n].rotation&&(o.rotation=i[n].rotation),"undefined"!=typeof i[n].size&&(o.size=i[n].size),"undefined"!=typeof i[n].position&&(o.position=i[n].position),i[n]=o}"undefined"!=typeof i[n].particles&&r(i[n].particles)}};return r(t.particles),t},e.getLinearParticles=function(){var t=[],e=function(r,i,n,o){"undefined"==typeof i&&(i=!1),"undefined"==typeof n&&(n=0),"undefined"==typeof o&&(o=1),i===!1&&(i={x:0,y:0,z:0}),r.forEach(function(r){r.position||(r.position={x:0,y:0,z:0}),"undefined"==typeof r.rotation&&(r.rotation=0),"undefined"==typeof r.size&&(r.size=1);var a=T.Math.xy2distDeg(r.position.x,r.position.y);a.dist=a.dist*o,a.deg+=n;var s=T.Math.distDeg2xy(a.dist,a.deg);r.rotation+=n,r.position.x=s.x,r.position.y=s.y,r.position.z=r.position.z*o,r.position.x+=i.x,r.position.y+=i.y,r.position.z+=i.z,"number"==typeof r.size?r.size=r.size*o:(r.size.x=r.size.x*o,r.size.y=r.size.y*o,r.size.z=r.size.z*o),"undefined"!=typeof r.particles?e(r.particles,r.position,r.rotation,r.size):"undefined"!=typeof r.shape&&t.push(r)})},r=this.getDeepCopyWithoutLinks();return e(r.particles,!1,r.rotation,r.size),t},e.filterPath=function(t){var e=this;if("undefined"==typeof t.forEach)throw r(t),new Error("Path is not correct array.");return t.forEach(function(t){e=e.particles[t]}),e},e.filterPathSiblings=function(t){var e=this.getDeepCopyWithoutLinks(),i=e;if("undefined"==typeof t.forEach)throw r(t),new Error("Path is not correct array.");return t.forEach(function(t,e){var r=i.particles[t];i.particles=[r],i=r}),e},MIXIN$0(t.prototype,e),e=void 0,t}(),T.Model.Particles=function(){"use strict";function t(){}DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1});var e={};return e.addMissingParams=function(t){return"undefined"==typeof t.skew&&(t.skew={}),"undefined"==typeof t.skew.z&&(t.skew.z={x:0,y:0}),"undefined"==typeof t.shape.top&&(t.shape.top=1),"undefined"==typeof t.shape.bottom&&(t.shape.bottom=1),"undefined"==typeof t.rotation&&(t.rotation=0),t},e.get3D=function(t){var e={};if(t=this.addMissingParams(t),"prism"!=t.shape.type)throw"Unknown particle shape "+t.shape.type;var r=t.position.x,i=t.position.y,n=t.position.z,o=t.size.x,a=t.size.y,s=t.size.z;e.points=[],e.polygons=[[],[]],e.polygons2D=[[],[]];for(var u,c=0;2>c;c++){u=0===c?t.shape.bottom:t.shape.top;for(var h,f,p,l=0;l<t.shape.n;l++){if(is(t.shape.rotated)){var d=2-Math.cos(T.Math.deg2rad(180/t.shape.n));h=o*(2*c-1),f=.5*a*Math.sin(l/t.shape.n*Math.PI*2+T.Math.deg2rad(180+180/t.shape.n)),p=.5*(s*Math.cos(l/t.shape.n*Math.PI*2+T.Math.deg2rad(180+180/t.shape.n))*d+s*Math.cos(T.Math.deg2rad(180/t.shape.n))*d)}else h=.5*o*Math.cos(l/t.shape.n*Math.PI*2+T.Math.deg2rad(180+180/t.shape.n))*u+o*(c*t.skew.z.x),f=.5*a*Math.sin(l/t.shape.n*Math.PI*2+T.Math.deg2rad(180+180/t.shape.n))*u+a*(c*t.skew.z.y),p=s*c;var y=T.Math.xy2distDeg(h,f);y.deg+=t.rotation;var g=T.Math.distDeg2xy(y.dist,y.deg);h=g.x,f=g.y,e.points.push([r+h,i+f,n+p]),0===c&&(e.polygons[0].push(l+1),e.polygons[1].push(l+1+t.shape.n),e.polygons2D[0].push(l+1),e.polygons2D[1].push(l+1+t.shape.n),e.polygons.push([0!==l?l:t.shape.n,l+1,l+1+t.shape.n,(0!==l?l:t.shape.n)+t.shape.n]))}}return e},e.get2Dlines=function(t,e){var r=this.get3D(t),i=[],n=[r.polygons2D[e]];for(var o in n)for(var a,s,u=-1,c=n[o].length;c-1>u;u++)a=-1!=u?u:c-1,s=u+1,a=r.points[n[o][a]-1],s=r.points[n[o][s]-1],i.push([{x:a[0],y:a[1]},{x:s[0],y:s[1]}]);return i},e.collisionLinesDetect=function(t,e){for(var r in t)for(var i in e)if(T.Math.lineCollision(t[r][0].x,t[r][0].y,t[r][1].x,t[r][1].y,e[i][0].x,e[i][0].y,e[i][1].x,e[i][1].y))return!0;return!1},e.collision2D=function(t,e){var r=Particles.get2Dlines(t,1),n=Particles.get2Dlines(e,0),o=Particles.collisionLinesDetect(r,n);return o||(o=function(){var t,e,o=100;for(i=0;i<2;i++){0===i?(t=JSON.parse(JSON.stringify(n)),e=r[0]):(t=JSON.parse(JSON.stringify(r)),e=n[0]);var a=JSON.parse(JSON.stringify(e)),s=JSON.parse(JSON.stringify(e)),u=e[1].x-e[0].x,c=e[1].y-e[0].y;a[0].x-=u*o,a[0].y-=c*o,s[1].x+=u*o,s[1].y+=c*o,a=[a],s=[s];var h=Particles.collisionLinesDetect(a,t),f=Particles.collisionLinesDetect(s,t);if(h&&f)return!0}return!1}()),o},MIXIN$0(t,e),e=void 0,t}(),T.setNamespace("Objects"),T.Objects.Array=function(){"use strict";function t(t){this.objects=[],t instanceof Array&&t.forEach(this.push,this)}var e={},r={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),r.getAll=function(){return this.objects},r.forEach=function(){return this.objects.forEach.apply(this.objects,arguments)},e.initInstance=function(t){if("building"==t.type)t=new T.Objects.Building(t);else if("terrain"==t.type)t=new T.Objects.Terrain(t);else if("story"==t.type)t=new T.Objects.Story(t);else{if("natural"!=t.type)throw new Error("Cant put item into Towns Objects Array because of unrecognized object type "+t.type);t=new T.Objects.Natural(t)}return t},r.push=function(t){return this.objects.push(T.Objects.Array.initInstance(t))},r.update=function(t){this.setById(t.id,t)||this.push(t)},r.getById=function(t){if("string"!=typeof t)throw new Error("getById: id should be string");for(var e in this.objects)if(this.objects[e].id==t)return this.objects[e];return null},r.setById=function(t,e){if("string"!=typeof t)throw new Error("setById: id should be string");for(var r in this.objects)if(this.objects[r].id==t)return this.objects[r]=T.Objects.Array.initInstance(e),!0;return!1},r.removeId=function(t,e){if("string"!=typeof t)throw new Error("removeId: id should be string");for(var r in this.objects)if(this.objects[r].id==t)return this.objects.splice(r,1),!0;return!1},r.filterTypes=function(){var t=new T.Objects.Array,e=Array.prototype.slice.call(arguments);return this.forEach(function(r){-1!=e.indexOf(r.type)&&t.push(r)}),t},r.getMapOfTerrainCodes=function(t,e){for(var r=[],i=0;2*e>i;i++){r[i]=[];for(var n=0;2*e>n;n++)r[i][n]=!1}for(var n,i,o,a=this.filterTypes("terrain").getAll(),s=0,u=a.length;u>s;s++)if(o=a[s],1==o.design.data.size)n=Math.floor(o.x-t.x+e),i=Math.floor(o.y-t.y+e),r[i][n]=o.getCode();else{var c=Math.floor(o.x-t.x+e-o.design.data.size),h=Math.ceil(o.x-t.x+e+o.design.data.size),f=Math.floor(o.y-t.y+e-o.design.data.size),p=Math.ceil(o.y-t.y+e+o.design.data.size),l=o.x-t.x+e,d=o.y-t.y+e;for(i=f;p>=i;i++)if("undefined"!=typeof r[i])for(n=c;h>=n;n++)"undefined"!=typeof r[i][n]&&T.Math.xy2dist(n-l,i-d)<=o.design.data.size&&(r[i][n]=o.getCode())}return r},r.get1x1TerrainObjects=function(){for(var t,e,r,i=new T.Objects.Array,n=this.filterTypes("terrain").getAll().slice().reverse(),o={},a=0,s=n.length;s>a;a++)if(r=n[a],1==r.design.data.size)t=r,e="x"+Math.round(t.x)+"y"+Math.round(t.y),"undefined"==typeof o[e]&&(o[e]=!0,i.push(t));else for(var u=Math.floor(-r.design.data.size),c=Math.ceil(r.design.data.size),h=Math.floor(-r.design.data.size),f=Math.ceil(r.design.data.size),p=h;f>=p;p++)for(var l=u;c>=l;l++)T.Math.xy2dist(l,p)<=r.design.data.size&&(t=r.clone(),t.design.data.size=1,t.x=Math.round(t.x+l),t.y=Math.round(t.y+p),e="x"+t.x+"y"+t.y,"undefined"==typeof o[e]&&(o[e]=!0,i.push(t)));return i},r.getTerrainOnPosition=function(t){for(var e=this.objects.length-1;e>=0;e--)if("terrain"==this.objects[e].type&&this.objects[e].design.data.size<=t.getDistance(new T.Position(this.objects[e].x,this.objects[e].y)))return this.objects[e];return null},r.getNearestTerrainPositionWithCode=function(t,e){var r=this.get1x1TerrainObjects(),i=-1,n=!1;return r.forEach(function(e){var r=e.getPosition().getDistance(t);(-1===i||i>r)&&(i=r,n=e)}),n===!1?null:n.getPosition()},MIXIN$0(t,e),MIXIN$0(t.prototype,r),e=r=void 0,t}(),T.Objects.Object=function(){"use strict";function t(t){for(var e in t){var r=e;"_id"==r&&(r="id"),this[r]=t[e]}}var e={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),e.getPosition=function(){return new T.Position(this.x,this.y)},MIXIN$0(t.prototype,e),e=void 0,t}(),T.Objects.Building=function(t){"use strict";function e(){null!==t&&t.apply(this,arguments)}t=T.Objects.Object,PRS$0||MIXIN$0(e,t),null!==t&&SP$0(e,t),e.prototype=OC$0(null!==t?t.prototype:null,{constructor:{value:e,configurable:!0,writable:!0}}),DP$0(e,"prototype",{configurable:!1,enumerable:!1,writable:!1});var r={};return r.clone=function(){return new T.Objects.Building(JSON.parse(JSON.stringify(this)))},r.getModel=function(){return this.design.data instanceof T.Model||(this.design.data=new T.Model(this.design.data)),this.design.data},MIXIN$0(e.prototype,r),r=void 0,e}(),T.Objects.Natural=function(t){"use strict";function e(){null!==t&&t.apply(this,arguments)}t=T.Objects.Object,PRS$0||MIXIN$0(e,t),null!==t&&SP$0(e,t),e.prototype=OC$0(null!==t?t.prototype:null,{constructor:{value:e,configurable:!0,writable:!0}}),DP$0(e,"prototype",{configurable:!1,enumerable:!1,writable:!1});var r={};return r.clone=function(){return new T.Objects.Natural(JSON.parse(JSON.stringify(this)))},r.getCode=function(){return this.design.data.image},MIXIN$0(e.prototype,r),r=void 0,e}(),T.Objects.Story=function(t){"use strict";function e(){null!==t&&t.apply(this,arguments)}t=T.Objects.Object,PRS$0||MIXIN$0(e,t),null!==t&&SP$0(e,t),e.prototype=OC$0(null!==t?t.prototype:null,{constructor:{value:e,configurable:!0,writable:!0}}),DP$0(e,"prototype",{configurable:!1,enumerable:!1,writable:!1});var r={};return r.clone=function(){return new T.Objects.Story(JSON.parse(JSON.stringify(this)))},r.getMarkdown=function(){return this.content.data},MIXIN$0(e.prototype,r),r=void 0,e}(),T.Objects.Terrain=function(t){"use strict";function e(){null!==t&&t.apply(this,arguments)}t=T.Objects.Object,PRS$0||MIXIN$0(e,t),null!==t&&SP$0(e,t),e.prototype=OC$0(null!==t?t.prototype:null,{constructor:{value:e,configurable:!0,writable:!0}}),DP$0(e,"prototype",{configurable:!1,enumerable:!1,writable:!1});var r={};return r.clone=function(){return new T.Objects.Terrain(JSON.parse(JSON.stringify(this)))},r.getCode=function(t){return this.design.data.image},r.getColor=function(){return this.design.data.color},MIXIN$0(e.prototype,r),r=void 0,e}(),T.Path=function(){"use strict";function t(t,e,r,i,n){var o,a,s;if(this.positions=[],i[Math.round(e.y)-n.y][Math.round(e.x)-n.x]===!1)throw"Wrong Destination";T.ArrayFunctions.iterate2D(i,function(t,e){i[t][e]!==!1&&(i[t][e]=!0)}),i[Math.round(t.y)-n.y][Math.round(t.x)-n.x]=0;for(var u=function(t,e){if("number"==typeof i[t][e]&&i[t][e]>=0)for(var r=t-1;t+1>=r;r++)for(var n=e-1;e+1>=n;n++)if((i[r][n]===!0||2>f)&&(n==e?r!=t:r==t)&&(n!=e||r!=t)&&n>=0&&r>=0&&n<2*map_radius&&r<2*map_radius){var o=T.Math.xy2dist(r-t,n-e);(i[r][n]===!0||2>f)&&(i[r][n]=-(i[t][e]+o))}},c=function(t,e){"number"==typeof i[t][e]&&(i[t][e]=Math.abs(i[t][e]))},h=!1,f=0;100>f&&!h;f++)T.ArrayFunctions.iterate2D(i,u),T.ArrayFunctions.iterate2D(i,c),"number"==typeof i[Math.round(e.y)-n.y][Math.round(e.x)-n.x]&&(h=!0);if(!h)throw"Cant find path";h=!1;var p=Math.round(e.x)-n.x,l=Math.round(e.y)-n.y;for(f=0;20>f&&!h;f++){0!==f&&this.positions.push(new T.Position(p+n.x,l+n.y)),o=0,a=!1,s=!1;for(var d=l-1;l+1>=d;d++)for(var y=p-1;p+1>=y;y++)y==p&&s==l||y>=0&&d>=0&&y<2*map_radius&&d<2*map_radius&&"number"==typeof i[d][y]&&i[l][p]-i[d][y]>=o&&(o=i[l][p]-i[d][y],a=y,s=d);if(a===!1||s===!1)throw new Error("Error in path",a,s);p=a,l=s,p==Math.round(t.x)-n.x&&l==Math.round(t.y)-n.y&&(h=!0)}this.positions.push(t),this.positions.reverse(),this.positions.push(e),this.times=[new Date];for(var g=this.times[0].getTime(),b=1,v=this.positions.length;v>b;b++)o=T.Math.xy2dist(this.positions[b].x-this.positions[b-1].x,this.positions[b].y-this.positions[b-1].y),g+=Math.round(1e3*o/r),this.times.push(new Date(g))}var e={},r={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),r.recount=function(){for(var t=new Date,e=t.getTime(),r=0,i=this.times.length-1;i>r;r++){var n=this.times[r].getTime(),o=this.times[r+1].getTime();if(e>=n&&o>e){var a=(e-n)/(o-n),s=this.positions[r+1].x-this.positions[r].x,u=this.positions[r+1].y-this.positions[r].y;return new T.Position(this.positions[r].x+s*a,this.positions[r].y+u*a)}}return!1},r.rotation=function(){for(var t=new Date,e=t.getTime(),r=0,i=this.times.length-1;i>r;r++){var n=this.times[r].getTime(),o=this.times[r+1].getTime();if(e>=n&&o>e){var a=this.positions[r+1].x-this.positions[r].x,s=this.positions[r+1].y-this.positions[r].y,u=T.Math.xy2distDeg(s,a);return u.deg+90}}return!1},r.inProgress=function(){var t=this.times[this.times.length-1],e=new Date,r=e.getTime();return t>r},e.is=function(t){return is(t)&&is(t.inProgress)?!!t.inProgress():!1},MIXIN$0(t,e),MIXIN$0(t.prototype,r),e=r=void 0,t}(),T.Position3D=function(){"use strict";function t(t,e,r){"object"==typeof t?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=r)}var e={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),e.clone=function(){return new T.Position3D(this)},e.toString=function(){return"["+this.x+","+this.y+","+this.z+"]"},MIXIN$0(t.prototype,e),e=void 0,t}(),T.PositionPolar=function(){"use strict";function t(t,e){"number"==typeof t&&"number"==typeof e&&(this.distance=t,this.degrees=e)}var e={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),e.clone=function(){return new T.PositionPolar(this)},e.getPosition=function(){var t=this.getRadians();return new T.Position(Math.cos(t)*this.distance,Math.sin(t)*this.distance)},e.getDistance=function(){return this.distance},e.getDegrees=function(){return this.degrees},e.getRadians=function(){return T.Math.deg2rad(this.degrees)},e.toString=function(){return""+this.distance+","+this.degrees+"°"},MIXIN$0(t.prototype,e),e=void 0,t}(),T.Position=function(){"use strict";function t(t,e){"object"==typeof t?(this.x=t.x,this.y=t.y):/^[+-]?\d+(\.\d+)?,[+-]?\d+(\.\d+)?$/.test(t)?(t=t.split(","),this.x=parseFloat(t[0]),this.y=parseFloat(t[1])):"number"==typeof t&&"number"==typeof e&&(this.x=t,this.y=e)}var e={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),e.clone=function(){return new T.Position(this)},e.plus=function(t){return this.x+=t.x,this.y+=t.y,this},e.multiply=function(t){return this.x=this.x*t,this.y=this.y*t,this},e.getPositionPolar=function(){return new T.PositionPolar(T.Math.xy2dist(this.x,this.y),T.Math.rad2deg(Math.atan2(this.y,this.x)))},e.getDistance=function(t){return T.Math.xy2dist(t.x-this.x,t.y-this.y)},e.toString=function(){return""+this.x+","+this.y},MIXIN$0(t.prototype,e),e=void 0,t}(),T.Resources=function(){"use strict";function t(t){for(var e in t)"number"==typeof t[e]&&(this[e]=Math.ceil(t[e]))}var e={},r={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),e.newSingles=function(t){var e=[];for(var r in t)if("number"==typeof t[r]&&t[r]>0){var i={};i[r]=t[r],e.push(new T.Resources(i))}return e},r.clone=function(){return new T.Resources(this)},r.contains=function(t){for(var e in t){if("number"==typeof this[e])return!1;if(this[e]<t[e])return!1}return!0},r.add=function(t){for(var e in t)"undefined"==typeof this[e]&&(this[e]=0),"number"==typeof this[e]&&(this[e]+=t[e]);return this},r.multiply=function(t){for(var e in this)"number"==typeof this[e]&&(this[e]=Math.ceil(this[e]*t));return this},r.signum=function(t){for(var e in this)"number"==typeof this[e]&&(this[e]>0?this[e]=1:this[e]=0);return this},r.apply=function(t){for(var e in this)"number"==typeof this[e]&&(this[e]=t(this[e]));return this},r.extractKeys=function(){var t=[];for(var e in this)"number"==typeof this[e]&&t.push(e);return t},r.compare=function(t){var e=this,r=t,i=[];i=i.concat(e.extractKeys()),i=i.concat(r.extractKeys()),i=i.filter(function(t,e,r){return r.indexOf(t)===e});var n=0;for(var o in i){var a=i[o],s=e[a],u=r[a];"undefined"==typeof s&&(s=0),"undefined"==typeof u&&(u=0),n+=Math.pow(s-u,2)}return n=Math.sqrt(n)},r.remove=function(t){if(!this.contains(t))return!1;for(var e in t)this[e]-=t[e];return!0},r.toString=function(){var t=[];for(var e in this)"number"==typeof this[e]&&0!==this[e]&&t.push(this[e]+" "+e);return t.join(", ")},r.toHTML=function(){var t=[];for(var e in this)if("number"==typeof this[e]&&0!==this[e]){var r=T.Locale.get("resource",e),i=this[e];i=i.toLocaleString(),t.push('<div><img src="/media/image/resources/'+e+'.png" title="'+r+'" alt="'+r+'" >'+i+"</div>")}return t=t.join(" "),t='<div class="resources">'+t+"</div>"},MIXIN$0(t,e),MIXIN$0(t.prototype,r),e=r=void 0,t}(),T.User=function(){"use strict";function t(t){for(var e in t){var r=e;this[r]=t[e]}}var e={};return DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),e.getSignatureHTML=function(){var t;t=this.profile.name||this.profile.surname?this.profile.name+" "+this.profile.surname:this.profile.username;var e=md5(this.profile.email),r='\n\n                <div class="user-signature">\n                    <img class="user-image" src="https://1.gravatar.com/avatar/'+e+'?s=80&r=pg&d=mm">\n\n                    <div class="user-signature-text">\n                        <h1 class="user-name">'+t+"</h1>\n                        <p>"+this.profile.description.html2text()+"</p>\n                    </div>\n\n                </div>\n\n            ";return r},MIXIN$0(t.prototype,e),e=void 0,t}(),T.setNamespace("World"),T.World.terrains=[new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:0,color:"#000000",size:1}},name:"temnota"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:1,color:"#337EFA",size:1}},name:"moře"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:2,color:"#545454",size:1}},name:"dlažba"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:3,color:"#EFF7FB",size:1}},name:"sníh/led"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:4,color:"#F9F98D",size:1}},name:"písek"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:5,color:"#878787",size:1}},name:"kamení"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:6,color:"#5A2F00",size:1}},name:"hlína"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:7,color:"#EFF7FB",size:1}},name:"sníh/led"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:8,color:"#2A7302",size:1}},name:"tráva(normal)"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:9,color:"#51F311",size:1}},name:"tráva(toxic)"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:10,color:"#535805",size:1}},name:"les"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:11,color:"#6aa2ff",size:1}},name:"řeka"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:12,color:"#8ABC02",size:1}},name:"tráva(jaro)"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:13,color:"#8A9002",size:1}},name:"tráva(pozim)"})],T.World.mapGenerator=new T.MapGenerator(T.Math.blurXY(function(t,e){for(var r,i,n=100,o=0,a=0,s=.4,u=1-s,c=0;11>c;c++)o+=Math.round(Math.pow(t*e-66,2))%(n+1),a+=n,r=-e*s+t*u,i=t*s+e*u,t=Math.floor(r/4),e=Math.floor(i/4);return o/=a,0>o&&(o-=Math.floor(o)),o>1&&(o-=Math.floor(o)),o},2),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,2e-4,3e-4,3e-4,5e-4,6e-4,7e-4,9e-4,.001,.001,.001,.0012,.0014,.0015,.0016,.0021,.0025,.003,.0033,.0034,.0037,.0038,.0042,.0046,.0049,.0057,.0065,.0068,.0072,.0074,.0079,.0084,.009,.0096,.0105,.0115,.0123,.0131,.0142,.0148,.0159,.0166,.0184,.019,.0204,.021,.022,.0232,.0245,.026,.0266,.0277,.029,.0297,.031,.0318,.0331,.0346,.0361,.0378,.0389,.0404,.0414,.0431,.0456,.0475,.0501,.0517,.0533,.0548,.0566,.0589,.0609,.0622,.0635,.0658,.0678,.0692,.0712,.0733,.0751,.0774,.079,.0813,.0837,.0859,.088,.0902,.0927,.0961,.0988,.1003,.1031,.105,.1071,.11,.1113,.1137,.1165,.1187,.1218,.1243,.1277,.1297,.1323,.1353,.1371,.1395,.1426,.1449,.1474,.1509,.1536,.156,.1582,.1605,.1633,.1662,.1692,.1726,.1755,.1781,.1813,.1842,.1869,.1899,.1939,.1975,.2001,.2029,.207,.2108,.2135,.2158,.2187,.221,.2238,.226,.2283,.2326,.2362,.2394,.2427,.2455,.2485,.2508,.2532,.2568,.2594,.2628,.2651,.2678,.2712,.2738,.276,.2792,.2819,.2852,.2885,.2908,.2943,.2969,.2994,.3019,.3049,.3077,.3108,.3135,.3162,.3194,.3216,.3243,.3276,.3307,.3334,.336,.3386,.3421,.3443,.3462,.3484,.351,.3535,.3569,.3593,.3618,.3642,.3659,.3681,.3706,.3722,.3742,.3772,.3794,.3816,.3837,.3865,.3879,.3907,.3925,.3947,.3967,.3985,.3998,.4021,.4035,.4054,.4067,.4088,.4107,.4133,.4141,.4161,.4177,.4193,.4209,.4219,.4234,.4245,.4264,.4283,.4302,.4318,.4327,.4346,.4363,.4381,.44,.4409,.4435,.445,.4462,.4484,.4492,.4506,.4518,.4533,.4548,.4554,.456,.4573,.4588,.4605,.4616,.463,.4638,.4656,.4663,.4672,.4684,.4696,.4708,.4721,.473,.4737,.4747,.4756,.4765,.4781,.4791,.4802,.4809,.4819,.4824,.483,.4838,.4847,.4859,.4865,.487,.4875,.4883,.4894,.4901,.4907,.4915,.4929,.4934,.494,.4949,.4955,.496,.4967,.4971,.4975,.4981,.499,.4997,.5005,.5008,.5018,.5024,.5032,.5038,.5042,.5046,.505,.5059,.5067,.507,.5074,.5077,.5084,.5086,.5095,.5104,.5109,.5117,.5122,.5129,.5136,.514,.5141,.5145,.515,.5153,.5157,.5162,.5169,.5172,.5176,.518,.5186,.5193,.5197,.5202,.5207,.5209,.5214,.5218,.5223,.5231,.5237,.5244,.5246,.5249,.5259,.5261,.5269,.5272,.5275,.5281,.5283,.5285,.5291,.5302,.531,.5317,.532,.5326,.5334,.5336,.5341,.5343,.5345,.5349,.5353,.5357,.5364,.5377,.5382,.5388,.5393,.5399,.5403,.5412,.5419,.543,.5437,.5446,.5457,.5466,.5476,.5482,.5486,.5491,.5495,.5503,.5506,.5515,.5522,.5527,.554,.555,.5553,.5557,.5562,.5569,.5578,.5586,.5595,.5608,.5616,.5626,.5634,.5645,.5652,.5667,.5673,.5683,.5697,.5707,.5723,.5739,.575,.5758,.5771,.5779,.5791,.5803,.5817,.5833,.5849,.5865,.5876,.5884,.5899,.5919,.5929,.5942,.5954,.5969,.5987,.5998,.6018,.6036,.6052,.6063,.6077,.6099,.6116,.6136,.6154,.6166,.6185,.6201,.6223,.6238,.6258,.6278,.6295,.631,.6324,.6344,.6358,.6372,.6395,.6414,.6434,.6451,.6472,.6493,.6513,.6536,.6559,.6578,.6598,.6622,.6638,.667,.6696,.671,.674,.6765,.679,.6811,.6836,.6861,.6884,.6903,.6933,.6946,.6976,.6997,.7027,.7049,.7084,.7109,.7128,.7164,.7189,.7222,.7245,.7271,.7305,.7326,.7367,.7398,.7421,.7443,.7461,.7483,.7507,.754,.7566,.7587,.7615,.7639,.7662,.7693,.7723,.7753,.7769,.7797,.7822,.7843,.7869,.7891,.7918,.7944,.7982,.801,.8041,.8068,.8094,.812,.8148,.8174,.82,.8219,.824,.8259,.8287,.8311,.8333,.8349,.8374,.841,.8433,.8456,.8481,.8518,.854,.8562,.8588,.862,.864,.8666,.8693,.8719,.8737,.8749,.8773,.8793,.8816,.8839,.887,.8888,.8905,.8924,.8948,.8966,.8986,.9009,.9029,.9039,.9063,.908,.9095,.911,.9125,.915,.9173,.9186,.9209,.9228,.9249,.9259,.927,.929,.9303,.9322,.9332,.9343,.9356,.9372,.9387,.9407,.9427,.944,.9459,.9473,.949,.9508,.9521,.9533,.9555,.9569,.958,.9592,.9606,.9612,.9617,.962,.9627,.9642,.9646,.9658,.967,.968,.9684,.9688,.9698,.9706,.9719,.9727,.974,.9747,.9761,.9774,.9785,.9793,.9802,.9811,.9817,.9823,.9828,.984,.9846,.9851,.9858,.9863,.9869,.987,.9874,.9879,.9886,.9888,.9895,.9903,.9904,.9907,.9912,.9913,.9917,.992,.9928,.9929,.9936,.9939,.9942,.9946,.9949,.9955,.9955,.9959,.9963,.9964,.9966,.9966,.9968,.9969,.9971,.9973,.9978,.9981,.9985,.9986,.9988,.9988,.9989,.9989,.999,.999,.999,.9993,.9993,.9993,.9993,.9993,.9993,.9996,.9996,.9997,.9997,.9997,.9998,.9999,.9999,.9999,.9999,.9999,.9999,.9999,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],new T.MapGenerator.Biotope([{
amount:120,terrain:T.World.terrains[1]},{amount:40,terrain:T.World.terrains[11]},{amount:30,terrain:T.World.terrains[4]},{amount:20,terrain:T.World.terrains[12]},{amount:40,terrain:T.World.terrains[9]},{amount:20,terrain:T.World.terrains[10]},{amount:10,terrain:T.World.terrains[8]},{amount:20,terrain:T.World.terrains[10]},{amount:20,terrain:T.World.terrains[12]},{amount:50,terrain:T.World.terrains[4]},{amount:10,terrain:T.World.terrains[13]},{amount:20,terrain:T.World.terrains[5]},{amount:60,terrain:T.World.terrains[3]},{amount:5,terrain:T.World.terrains[10]},{amount:60,terrain:T.World.terrains[7]},{amount:10,terrain:T.World.terrains[5]}]),function(t,e){"terrain"==t.type&&(5==t.getCode()?e.push({x:t.x,y:t.y,type:"natural",design:{type:"natural",data:{image:"rock"+Math.floor(6*T.Math.randomSeedPosition(1,{x:t.x,y:t.y}))%6+"dark"+Math.floor(4*T.Math.randomSeedPosition(2,{x:t.x,y:t.y}))%4,size:.5+1*T.Math.randomSeedPosition(5,{x:t.x,y:t.y})}}}):10==t.getCode()&&e.push({x:t.x,y:t.y,type:"natural",design:{type:"natural",data:{image:"tree"+Math.floor(10*T.Math.randomSeedPosition(3,{x:t.x,y:t.y}))%10,size:1+T.Math.randomSeedPosition(6,{x:t.x,y:t.y})/2}}}))});var K=.05;T.World.game=new T.Game({defense:new T.Game.ActionType("passive",{defense:"number"},function(t){return 800*t.defense*K},T.Resources.newSingles({wood:2,clay:2,stone:1,iron:0})),regenerate:new T.Game.ActionType("passive",{regenerate:"number"},function(t){return 1/t.regenerate*3600*K},T.Resources.newSingles({wood:4,clay:2,stone:2,iron:2})),repair:new T.Game.ActionType("active",{repair:"number"},function(t){return 1/(t.repair/100)*1e3*K},T.Resources.newSingles({wood:4,clay:2,stone:3,iron:4}),function(t,e){}),mine:new T.Game.ActionType("passive",{resource:"string",amount:"number"},function(t){return 3600*t.amount*K},T.Resources.newSingles({wood:3,clay:2,stone:2,iron:4})),attack:new T.Game.ActionType("active",{distance:"number",strength:"number",rounds:"number",cooldown:"number"},function(t){return Math.pow(t.distance,2)*t.strength*t.rounds*(1/t.cooldown)*100*K},T.Resources.newSingles({wood:2,clay:0,stone:3,iron:2}),function(t,e){}),move:new T.Game.ActionType("active",{speed:"number"},function(t){return 10*Math.pow(t.speed,2)*K},T.Resources.newSingles({wood:2,clay:0,stone:0,iron:1}),function(t,e){}),throughput:new T.Game.ActionType("passive",{throughput:"number"},function(t){return 10*Math.pow(t.throughput/100,2)*K},T.Resources.newSingles({wood:2,clay:3,stone:1,iron:0}))},T.Math.prettyNumber,T.Math.prettyNumber);