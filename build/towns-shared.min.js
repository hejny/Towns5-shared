var PRS$0=function(e,t){return e.__proto__={a:t},e.a===t}({},{}),DP$0=Object.defineProperty,GOPD$0=Object.getOwnPropertyDescriptor,MIXIN$0=function(e,t){for(var r in t)t.hasOwnProperty(r)&&DP$0(e,r,GOPD$0(t,r));return e},SP$0=Object.setPrototypeOf||function(e,t){return PRS$0?e.__proto__=t:DP$0(e,"__proto__",{value:t,configurable:!0,enumerable:!1,writable:!0}),e},OC$0=Object.create;global.Towns={},module.exports=global.Towns;var T=global.Towns,A=T;A.Game=function(e,t,r){this.action_type_list=e,this.max_life_modifier=t,this.price_key_modifier=r},A.Game.prototype.getObjectPriceBases=function(e){var t=this,r=[];return"undefined"==typeof e.actions?[]:(e.actions.forEach(function(e){if("undefined"==typeof t.action_type_list[e.type])throw new Error("Unknown action type "+e.type);var n=t.action_type_list[e.type];for(var i in n.params){var o=n.params[i];if(typeof e.params[i]!=o)throw new Error("Param "+i+" should be "+o+" in action "+e.type)}var a=Math.ceil(n.price_base(e.params));if(0>a)throw new Error("Params in action "+e.type+" should not make this action negative");r.push(a)}),r)},A.Game.prototype.getObjectMaxLife=function(e){var t=this.getObjectPriceBases(e),r=t.reduce(function(e,t){return e+t},0);return r=this.max_life_modifier(r)},A.Game.prototype.getObjectPrices=function(e){var t=this.getObjectPriceBases(e),r=this,n=[];if("undefined"==typeof e.actions)return[];var i=r.getObjectDesignPrice(e);return e.actions.forEach(function(e,o){var a=r.action_type_list[e.type];a.price_resources_list.sort(function(e,t){return i.compare(e.clone().signum())-i.compare(t.clone().signum())});var s=a.price_resources_list[0].clone();s.multiply(t[o]),n.push(s)}),n},A.Game.prototype.getObjectPrice=function(e){var t=new T.Resources({}),r=this.getObjectPrices(e);return r.forEach(function(e){t.add(e)}),t.apply(this.price_key_modifier),t},A.Game.prototype.getObjectDesignPrice=function(e){if(!e.hasOwnProperty("design"))throw new Error("Object should have design!");if("model"!=e.design.type)throw new Error("Object should have design of type model!");var t=new T.Resources({});return model=new T.Model(e.design.data),linear_particles=model.getLinearParticles(),linear_particles.forEach(function(e){var r=e.size.x*e.size.y*e.size.z,n=e.material.split("_");n=n[0];var i={};i[n]=r,t.add(i)}),t},T.Game=T.Game||{};var A=T.Game;A.ActionType=function(e,t,r,n,i){this.type=e,this.params=t,this.price_base=r,this.price_resources_list=n,this.perform=i};var A=T;A.MapGenerator=function(e,t,r,n){this.getZ=e,this.z_normalizing_table=t,this.biotope=r,this.virtualObjectGenerator=n},A.MapGenerator.prototype.getZMapCircle=function(e,t){for(var r=[],n=0;2*t>=n;n++){r[n]=[];for(var i=0;2*t>=i;i++)if(!(Math.pow(i-t+.5,2)+Math.pow(n-t+.5,2)>Math.pow(t,2))){var o=this.getZ(i-t+e.x,n-t+e.y);r[n][i]=this.z_normalizing_table[Math.floor(o*this.z_normalizing_table.length)]}}return r},A.MapGenerator.prototype.terrainMap=function(e){for(var t=[],r=0,n=e.length;n>r;r++){t[r]=[];for(var i=0;n>i;i++)"undefined"!=typeof e[r][i]&&(t[r][i]=this.biotope.getZTerrain(e[r][i]))}return t},A.MapGenerator.prototype.getMapArrayCircle=function(e,t){var r=this.getZMapCircle(e,t),n=this.terrainMap(r);return n},A.MapGenerator.prototype.convertMapArrayToObjects=function(e,t,r){for(var n=new T.Objects.Array,i=0;2*r>i;i++)for(var o=0;2*r>o;o++)if("undefined"!=typeof e[i][o]){var a=new T.Objects.Terrain(e[i][o]);a.x=t.x-r+o,a.y=t.y-r+i,n.push(a)}return n},A.MapGenerator.prototype.getPureMap=function(e,t){center_integer={x:Math.floor(e.x),y:Math.floor(e.y)};var r=this.getMapArrayCircle(center_integer,t),n=this.convertMapArrayToObjects(r,center_integer,t);return n},A.MapGenerator.prototype.getVirtualObjectsFromTerrainObjects=function(e){var t=this,r=[];return e.forEach(function(e){t.virtualObjectGenerator(e,r)}),r},A.MapGenerator.prototype.getCompleteObjects=function(e,t,r,n){"undefined"==typeof n&&(n=!0);var i=this.getPureMap(t,r);if(n){var n=this.getVirtualObjectsFromTerrainObjects(e);n.forEach(function(e){i.push(e)})}return e.forEach(function(e){i.push(e)}),i},T.MapGenerator=T.MapGenerator||{};var A=T.MapGenerator;A.Biotope=function(e){var t=0;e.forEach(function(e){t+=e.amount});var r=0;e.forEach(function(e){e.from=r/t,r+=e.amount}),this.terrains=e},A.Biotope.prototype.getZTerrain=function(e){for(var t=this.terrains.length-1;t>=0;t--)if(e>=this.terrains[t].from)return this.terrains[t].terrain};var A=T;A.Math={},A.Math.sign=Math.sign||function(e){return e=+e,0===e||isNaN(e)?e:e>0?1:-1},A.Math.baseLog=function(e,t){return Math.log(t)/Math.log(e)},A.Math.prettyNumber=function(e,t){t=t||2;var r=Math.ceil(T.Math.baseLog(10,e)),n=Math.pow(10,t-r);return e*=n,e=Math.round(e),e/=n},A.Math.angleDiff=function(e,t){var r=e-t,r=(r+180)%360-180;return r},A.Math.rad2deg=function(e){return e*(180/Math.PI)},A.Math.deg2rad=function(e){return e*(Math.PI/180)},A.Math.xy2dist=function(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))},A.Math.xy2distDeg=function(e,t){var r={};return r.dist=this.xy2dist(e,t),r.deg=this.rad2deg(Math.atan2(t,e)),r},A.Math.distDeg2xy=function(e,t){var r=this.deg2rad(t),n={};return n.x=Math.cos(r)*e,n.y=Math.sin(r)*e,n},A.Math.xyRotate=function(e,t,r){var n=this.xy2dist(e,t),i=Math.atan2(t,e);i+=this.deg2rad(r);var o={};return o.x=Math.cos(i)*n,o.y=Math.sin(i)*n,o},A.Math.randomSeedPosition=function(e,t){return(Math.sin(Math.pow(t.x*t.y-e,2))+1)/2},A.Math.toFloat=function(e,t){return"undefined"==typeof t&&(t=0),"undefined"==typeof e?t:(e=parseFloat(e),isNaN(e)?t:e)},A.Math.toInt=function(e,t){return"undefined"==typeof e?t:(e=parseInt(e),isNaN(e)?t:e)},A.Math.bounds=function(e,t,r){return t>e?t:e>r?r:e},A.Math.lineCollision=function(e,t,r,n,i,o,a,s){var p=(r-e)*(s-o)-(n-t)*(a-i),c=(t-o)*(a-i)-(e-i)*(s-o),u=(t-o)*(r-e)-(e-i)*(n-t);if(0==p)y=!1;else var f=c/p,h=u/p,y=f>=0&&1>=f&&h>=0&&1>=h;return y},A.Math.blurXY=function(e,t){return function(r,n){var i=0,o=0;for(xx=r-t;xx<=r+t;xx++)for(yy=n-t;yy<=n+t;yy++)Math.pow(t,2)<Math.pow(xx-r,2)+Math.pow(yy-n,2)||(i+=e(xx,yy),o++);return i/o}};var A=T;module.exports=Towns,A.Model=function(e){return"undefined"==typeof e?!1:(this.name=e.name,this.particles=e.particles,this.rotation=e.rotation,this.size=e.size,"undefined"==typeof this.rotation&&(this.rotation=0),void("undefined"==typeof this.size&&(this.size=1)))},A.Model.prototype.addRotationSize=function(e,t){"undefined"==typeof e&&(e=0),"undefined"==typeof t&&(t=1),this.rotation+=e,this.size=this.size*t},A.Model.prototype.clone=function(){return new T.Model(JSON.parse(JSON.stringify(this)))},A.Model.prototype.range=function(e){if("xy"==e)return T.Math.xy2dist(this.range("x"),this.range("y")*this.size);var t,r,n=this.getLinearParticles(),i=!1,o=!1;for(var a in n)r=n[a].position[e],t=n[a].position[e]+n[a].size[e],i===!1&&(i=t),o===!1&&(o=r),t>i&&(i=t),o>r&&(o=r);return Math.abs(o-i)},A.Model.prototype.moveBy=function(e,t,r){"undefined"==typeof e&&(e=0),"undefined"==typeof t&&(t=0),"undefined"==typeof r&&(r=0);for(var n in this.particles)this.particles[n].position.x+=e,this.particles[n].position.y+=t,this.particles[n].position.z+=r},A.Model.prototype.joinModelZ=function(e,t,n){var i=this.getLinearParticles(),o=e.getLinearParticles(),a=[0];for(var s in o){o[s].position.x+=t,o[s].position.y+=n;for(var p in i)Particles.collision2D(i[p],o[s])&&(r(i[p],o[s]),a.push(i[p].position.z+i[p].size.z))}var c=Math.max.apply(Math,a);return c},A.Model.prototype.joinModel=function(e,t,r){var n=this.joinModelZ(e,t,r);this.particles=[JSON.parse(JSON.stringify(this)),JSON.parse(JSON.stringify(e))],this.particles[1].position={x:t,y:r,z:n},this.rotation=0,this.size=1},A.Model.prototype.getDeepCopyWithoutLinks=function(){var e=this.clone(),t=function(e,r){for(var n in e){if(e[n].name==r)return e[n];if("undefined"!=typeof e[n].particles){var i=t(e[n].particles,r);if(i!==!1)return i}}return!1},r=function(n){for(var i in n){if("undefined"!=typeof n[i].link){var o=t(e.particles,n[i].link);if(0==o)throw new Error("Invalid link "+particle.link);o=JSON.parse(JSON.stringify(o)),"undefined"!=typeof n[i].rotation&&(o.rotation=n[i].rotation),"undefined"!=typeof n[i].size&&(o.size=n[i].size),"undefined"!=typeof n[i].position&&(o.position=n[i].position),n[i]=o}"undefined"!=typeof n[i].particles&&r(n[i].particles)}};return r(e.particles),e},A.Model.prototype.getLinearParticles=function(){var e=[],t=function(r,n,i,o){"undefined"==typeof n&&(n=!1),"undefined"==typeof i&&(i=0),"undefined"==typeof o&&(o=1),n===!1&&(n={x:0,y:0,z:0}),r.forEach(function(r){r.position||(r.position={x:0,y:0,z:0}),"undefined"==typeof r.rotation&&(r.rotation=0),"undefined"==typeof r.size&&(r.size=1);var a=T.Math.xy2distDeg(r.position.x,r.position.y);a.dist=a.dist*o,a.deg+=i;var s=T.Math.distDeg2xy(a.dist,a.deg);r.rotation+=i,r.position.x=s.x,r.position.y=s.y,r.position.z=r.position.z*o,r.position.x+=n.x,r.position.y+=n.y,r.position.z+=n.z,"number"==typeof r.size?r.size=r.size*o:(r.size.x=r.size.x*o,r.size.y=r.size.y*o,r.size.z=r.size.z*o),"undefined"!=typeof r.particles?t(r.particles,r.position,r.rotation,r.size):"undefined"!=typeof r.shape&&e.push(r)})},r=this.getDeepCopyWithoutLinks();return t(r.particles,!1,r.rotation,r.size),e},A.Model.prototype.filterPath=function(e){var t=this;if("undefined"==typeof e.forEach)throw r(e),new Error("Path is not correct array.");return e.forEach(function(e){t=t.particles[e]}),t},A.Model.prototype.filterPathSiblings=function(e){var t=this.getDeepCopyWithoutLinks(),n=t;if("undefined"==typeof e.forEach)throw r(e),new Error("Path is not correct array.");return e.forEach(function(e,t){var r=n.particles[e];n.particles=[r],n=r}),t},T.Model=T.Model||{};var A=T.Model;A.Particles={},A.Particles.cParams=function(e){return"undefined"==typeof e.skew&&(e.skew={}),"undefined"==typeof e.skew.z&&(e.skew.z={x:0,y:0}),"undefined"==typeof e.shape.top&&(e.shape.top=1),"undefined"==typeof e.shape.bottom&&(e.shape.bottom=1),"undefined"==typeof e.rotation&&(e.rotation=0),e},A.Particles.get3D=function(e){var t={};if(e=T.Model.Particles.cParams(e),"prism"!=e.shape.type)throw"Unknown particle shape "+e.shape.type;var r=e.position.x,n=e.position.y,i=e.position.z,o=e.size.x,a=e.size.y,s=e.size.z;t.points=[],t.polygons=[[],[]],t.polygons2D=[[],[]];for(var p=0;2>p;p++){if(0==p)var c=e.shape.bottom;else var c=e.shape.top;for(var u=0;u<e.shape.n;u++){if(is(e.shape.rotated)){var f=2-Math.cos(T.Math.deg2rad(180/e.shape.n)),h=o*(2*p-1);y=.5*a*Math.sin(u/e.shape.n*Math.PI*2+T.Math.deg2rad(180+180/e.shape.n)),l=.5*(s*Math.cos(u/e.shape.n*Math.PI*2+T.Math.deg2rad(180+180/e.shape.n))*f+s*Math.cos(T.Math.deg2rad(180/e.shape.n))*f)}else var h=.5*o*Math.cos(u/e.shape.n*Math.PI*2+T.Math.deg2rad(180+180/e.shape.n))*c+o*(p*e.skew.z.x),y=.5*a*Math.sin(u/e.shape.n*Math.PI*2+T.Math.deg2rad(180+180/e.shape.n))*c+a*(p*e.skew.z.y),l=s*p;var d=T.Math.xy2distDeg(h,y);d.deg+=e.rotation;var g=T.Math.distDeg2xy(d.dist,d.deg);h=g.x,y=g.y,t.points.push([r+h,n+y,i+l]),0==p&&(t.polygons[0].push(u+1),t.polygons[1].push(u+1+e.shape.n),t.polygons2D[0].push(u+1),t.polygons2D[1].push(u+1+e.shape.n),t.polygons.push([0!=u?u:e.shape.n,u+1,u+1+e.shape.n,(0!=u?u:e.shape.n)+e.shape.n]))}}return t},A.Particles.get2Dlines=function(e,t){var r=this.get3D(e),n=[],i=[r.polygons2D[t]];for(var o in i)for(var a=-1,s=i[o].length;s-1>a;a++){if(-1!=a)var p=a;else var p=s-1;var c=a+1;p=r.points[i[o][p]-1],c=r.points[i[o][c]-1],n.push([{x:p[0],y:p[1]},{x:c[0],y:c[1]}])}return n},A.Particles.collisionLinesDetect=function(e,t){for(var r in e)for(var n in t)if(T.Math.lineCollision(e[r][0].x,e[r][0].y,e[r][1].x,e[r][1].y,t[n][0].x,t[n][0].y,t[n][1].x,t[n][1].y))return!0;return!1},A.Particles.collision2D=function(e,t){var r=Particles.get2Dlines(e,1),n=Particles.get2Dlines(t,0),o=Particles.collisionLinesDetect(r,n);return o||(o=function(){var e=100;for(i=0;i<2;i++){if(0==i)var t=JSON.parse(JSON.stringify(n)),o=r[0];else var t=JSON.parse(JSON.stringify(r)),o=n[0];var a=JSON.parse(JSON.stringify(o)),s=JSON.parse(JSON.stringify(o)),p=o[1].x-o[0].x,c=o[1].y-o[0].y;a[0].x-=p*e,a[0].y-=c*e,s[1].x+=p*e,s[1].y+=c*e,a=[a],s=[s];var u=Particles.collisionLinesDetect(a,t),f=Particles.collisionLinesDetect(s,t);if(u&&f)return!0}return!1}()),o},T.Objects=T.Objects||{};var A=T.Objects;A.Array=function(e){this.objects=[],e instanceof Array&&e.forEach(this.push,this)},A.Array.prototype.getAll=function(){return this.objects},A.Array.prototype.forEach=function(){return this.objects.forEach.apply(this.objects,arguments)},A.Array.prototype.push=function(e){if("building"==e.type)e=new T.Objects.Building(e);else if("terrain"==e.type)e=new T.Objects.Terrain(e);else if("story"==e.type)e=new T.Objects.Story(e);else{if("natural"!=e.type)throw new Error("Cant put item into Towns Objects Array because of unrecognized object type "+e.type);e=new T.Objects.Natural(e)}return this.objects.push(e)},A.Array.prototype.getById=function(e){for(var t in this.objects)if(this.objects[t].id==e||this.objects[t]._id==e)return this.objects[t];return null},A.Array.prototype.setById=function(e,t){for(var r in this.objects)if(this.objects[r].id==e||this.objects[r]._id==e)return this.objects[r]=t,!0;return!1},A.Array.prototype.filterTypes=function(){var e=new T.Objects.Array,t=Array.prototype.slice.call(arguments);return this.forEach(function(r){-1!=t.indexOf(r.type)&&e.push(r)}),e},A.Array.prototype.getMapOfTerrainCodes=function(e,t){for(var r=[],n=0;2*t>n;n++){r[n]=[];for(var i=0;2*t>i;i++)r[n][i]=!1}return this.objects.forEach(function(n){if("terrain"==n.type)if(1==n.design.data.size){var i=Math.floor(n.x-e.x+t),o=Math.floor(n.y-e.y+t);r[o][i]=n.getCode()}else for(var a=Math.floor(n.x-e.x+t-n.design.data.size),s=Math.ceil(n.x-e.x+t+n.design.data.size),p=Math.floor(n.y-e.y+t-n.design.data.size),c=Math.ceil(n.y-e.y+t+n.design.data.size),u=t+e.x-n.x,f=t+e.y-n.y,o=p;c>=o;o++)if("undefined"!=typeof r[o])for(var i=a;s>=i;i++)"undefined"!=typeof r[o][i]&&T.Math.xy2dist(i-u,o-f)<=n.design.data.size&&(r[o][i]=n.getCode())}),r},A.Array.prototype.get1x1TerrainObjects=function(){var e=new T.Objects.Array,t=this.filterTypes("terrain").getAll().reverse();return t.forEach(function(t){for(var r=Math.floor(-t.design.data.size),n=Math.ceil(t.design.data.size),i=Math.floor(-t.design.data.size),o=Math.ceil(t.design.data.size),a=i;o>=a;a++)for(var s=r;n>=s;s++)if(T.Math.xy2dist(s,a)<=t.design.data.size){var p=t.clone();p.design.data.size=1,p.x+=s,p.y+=a,e.getAll().some(function(e){return e.x==p.x&&e.y==p.y?!0:void 0})||e.push(p)}}),e},A.Array.prototype.getTerrainOnPosition=function(e){for(var t=this.objects.length-1;t>=0;t--)if("terrain"==this.objects[t].type&&this.objects[t].design.data.size<=e.getDistance(new T.Position(this.objects[t].x,this.objects[t].y)))return this.objects[t];return null},A.Array.prototype.getNearestTerrainPositionWithCode=function(e,t){var r=this.get1x1TerrainObjects(),n=-1,i=!1;return r.forEach(function(t){var r=t.getPosition().getDistance(e);(-1===n||n>r)&&(n=r,i=t)}),i===!1?null:i.getPosition()},T.Objects=T.Objects||{};var A=T.Objects;A.Object=function(){"use strict";function e(e){for(var t in e)this[t]=e[t]}var t={};return DP$0(e,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t.getPosition=function(){return new T.Position(this.x,this.y)},MIXIN$0(e.prototype,t),t=void 0,e}(),T.Objects=T.Objects||{};var A=T.Objects;A.Building=function(e){"use strict";function t(){null!==e&&e.apply(this,arguments)}return e=A.Object,PRS$0||MIXIN$0(t,e),null!==e&&SP$0(t,e),t.prototype=OC$0(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0}}),DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t}(),T.Objects=T.Objects||{};var A=T.Objects;A.Natural=function(e){"use strict";function t(){null!==e&&e.apply(this,arguments)}return e=A.Object,PRS$0||MIXIN$0(t,e),null!==e&&SP$0(t,e),t.prototype=OC$0(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0}}),DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t}(),T.Objects=T.Objects||{};var A=T.Objects;A.Story=function(e){"use strict";function t(){null!==e&&e.apply(this,arguments)}return e=A.Object,PRS$0||MIXIN$0(t,e),null!==e&&SP$0(t,e),t.prototype=OC$0(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0}}),DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t}(),T.Objects=T.Objects||{};var A=T.Objects;A.Terrain=function(e){"use strict";function t(){null!==e&&e.apply(this,arguments)}e=A.Object,PRS$0||MIXIN$0(t,e),null!==e&&SP$0(t,e),t.prototype=OC$0(null!==e?e.prototype:null,{constructor:{value:t,configurable:!0,writable:!0}}),DP$0(t,"prototype",{configurable:!1,enumerable:!1,writable:!1});var r={};return r.getCode=function(e){return this.design.data.image},r.getColor=function(){return this.design.data.color},r.clone=function(){return new T.Objects.Terrain(JSON.parse(JSON.stringify(this)))},MIXIN$0(t.prototype,r),r=void 0,t}();var A=T;A.Position=function(e,t){"object"==typeof e?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)},A.Position.prototype.getMoved=function(e,t){return new T.Position(this.x+e,this.y+t)},A.Position.prototype.getDistance=function(e){return T.Math.xy2dist(e.x-this.x,e.y-this.y)},A.Position.prototype.toString=function(){return"["+this.x+","+this.y+"]"};var A=T;A.Resources=function(e){for(var t in e)"number"==typeof e[t]&&(this[t]=Math.ceil(e[t]))},A.Resources.newSingles=function(e){var t=[];for(var r in e)if("number"==typeof e[r]&&e[r]>0){var n={};n[r]=e[r],t.push(new T.Resources(n))}return t},A.Resources.prototype.clone=function(){return new T.Resources(this)},A.Resources.prototype.contains=function(e){for(var t in e){if("number"==typeof this[t])return!1;if(this[t]<e[t])return!1}return!0},A.Resources.prototype.add=function(e){for(var t in e)"undefined"==typeof this[t]&&(this[t]=0),"number"==typeof this[t]&&(this[t]+=e[t]);return this},A.Resources.prototype.multiply=function(e){for(var t in this)"number"==typeof this[t]&&(this[t]=Math.ceil(this[t]*e));return this},A.Resources.prototype.signum=function(e){for(var t in this)"number"==typeof this[t]&&(this[t]>0?this[t]=1:this[t]=0);return this},A.Resources.prototype.apply=function(e){for(var t in this)"number"==typeof this[t]&&(this[t]=e(this[t]));return this},A.Resources.prototype.extractKeys=function(){var e=[];for(var t in this)"number"==typeof this[t]&&e.push(t);return e},A.Resources.prototype.compare=function(e){var t=this,r=e,n=[];n=n.concat(t.extractKeys()),n=n.concat(r.extractKeys()),n=n.filter(function(e,t,r){return r.indexOf(e)===t});var i=0;for(var o in n){var a=n[o];val_A=t[a],val_B=r[a],"undefined"==typeof val_A&&(val_A=0),"undefined"==typeof val_B&&(val_B=0),i+=Math.pow(val_A-val_B,2)}return i=Math.sqrt(i)},A.Resources.prototype.remove=function(e){if(!this.contains(e))return!1;for(var t in e)this[t]-=e[t];return!0},A.Resources.prototype.toString=function(){var e=[];for(var t in this)"number"==typeof this[t]&&0!=this[t]&&e.push(this[t]+" "+t);return e.join(", ")},T.World=T.World||{};var A=T.World;A.terrains=[new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:0,color:"#000000",size:1}},name:"temnota"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:1,color:"#337EFA",size:1}},name:"moře"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:2,color:"#545454",size:1}},name:"dlažba"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:3,color:"#EFF7FB",size:1}},name:"sníh/led"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:4,color:"#F9F98D",size:1}},name:"písek"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:5,color:"#878787",size:1}},name:"kamení"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:6,color:"#5A2F00",size:1}},name:"hlína"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:7,color:"#EFF7FB",size:1}},name:"sníh/led"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:8,color:"#2A7302",size:1}},name:"tráva(normal)"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:9,color:"#51F311",size:1}},name:"tráva(toxic)"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:10,color:"#535805",size:1}},name:"les"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:11,color:"#6aa2ff",size:1}},name:"řeka"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:12,color:"#8ABC02",size:1}},name:"tráva(jaro)"}),new T.Objects.Terrain({type:"terrain",design:{type:"terrain",data:{image:13,color:"#8A9002",size:1}},name:"tráva(pozim)"})],T.World=T.World||{};var A=T.World;A.mapGenerator=new T.MapGenerator(T.Math.blurXY(function(e,t){for(var r=100,n=0,i=0,o=0;13>o;o++){n+=Math.round(Math.pow(e*t-66,2))%(r+1),i+=r,e=Math.floor(e/3),t=Math.floor(t/3);var a=T.Math.xyRotate(e,t,57);e=a.x,t=a.y}return n/=i,0>n&&(n-=Math.floor(n)),n>1&&(n-=Math.floor(n)),n},2),[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,1e-4,2e-4,2e-4,2e-4,2e-4,2e-4,2e-4,2e-4,2e-4,2e-4,2e-4,3e-4,3e-4,3e-4,3e-4,4e-4,5e-4,6e-4,7e-4,9e-4,9e-4,9e-4,.001,.0011,.0011,.0011,.0011,.0012,.0012,.0013,.0013,.0015,.0016,.0017,.0017,.0017,.002,.0021,.0023,.0024,.0028,.0031,.0033,.0034,.0037,.0044,.0045,.0047,.0049,.0049,.0051,.0054,.0058,.0061,.0062,.0064,.0067,.0071,.0074,.0075,.0078,.0082,.0083,.0084,.0088,.0092,.0097,.0102,.0107,.0112,.0123,.0131,.0139,.0147,.0149,.0153,.0163,.0168,.0175,.0181,.0188,.0193,.0203,.0212,.022,.0221,.0224,.0227,.0232,.0239,.0251,.0256,.0264,.0268,.0281,.0286,.0294,.0301,.0312,.0317,.0328,.0338,.035,.0356,.0368,.0377,.0387,.0402,.0409,.0422,.0438,.0446,.0458,.0475,.0486,.0502,.0513,.052,.0534,.0539,.0548,.056,.0568,.0578,.0595,.0607,.0624,.0634,.0644,.0664,.0677,.0694,.071,.072,.0734,.0747,.0757,.0767,.0785,.0794,.0805,.0817,.0826,.084,.0856,.087,.0883,.0898,.0915,.0923,.094,.0945,.0958,.0972,.0983,.0996,.1014,.1031,.1048,.1057,.1072,.1087,.1103,.1111,.1126,.1143,.1161,.1171,.1189,.1203,.1219,.1238,.1251,.1261,.1273,.129,.1303,.1315,.1324,.1331,.1341,.1355,.1368,.1387,.1397,.1408,.1427,.1437,.145,.1462,.1479,.1498,.1512,.1521,.1538,.1549,.1566,.1581,.1594,.1616,.1628,.1642,.1652,.1669,.1682,.17,.1713,.1727,.1742,.1764,.1782,.1795,.1817,.1835,.1851,.1859,.1865,.188,.1894,.191,.1921,.1935,.1947,.1962,.1975,.1986,.2001,.2011,.2022,.2028,.2046,.2058,.2069,.2079,.2093,.2105,.2122,.2135,.2145,.2154,.2163,.2171,.2183,.2193,.22,.2212,.2221,.2235,.2245,.2261,.2276,.2284,.2293,.2303,.2313,.2327,.2341,.2356,.2369,.2374,.2392,.2405,.242,.2435,.2449,.2466,.2481,.25,.2509,.2525,.2539,.2552,.2561,.2577,.2589,.2615,.2627,.2646,.2657,.2671,.269,.2706,.2719,.2732,.2743,.2764,.2779,.28,.2818,.2828,.2844,.2866,.288,.2892,.2912,.2926,.2938,.2963,.2979,.2996,.3013,.3028,.3052,.3066,.3077,.3098,.312,.3142,.3159,.3173,.3194,.3213,.3231,.3258,.3281,.3297,.332,.3347,.3363,.3384,.3409,.3432,.3464,.3483,.35,.3528,.3564,.3592,.3624,.3651,.3687,.3708,.3732,.3755,.379,.3811,.3836,.3865,.3888,.3912,.3948,.3974,.3998,.4019,.4045,.4082,.4106,.4145,.4168,.4195,.4221,.4247,.4266,.4293,.4313,.4364,.439,.4432,.4467,.4498,.4531,.4553,.4588,.4614,.4654,.4689,.4725,.4765,.4786,.4813,.4857,.4898,.4931,.4975,.5013,.5058,.5102,.5134,.5177,.5224,.5252,.5292,.5327,.5366,.5404,.5433,.5484,.5514,.5548,.5591,.5624,.5661,.5702,.5745,.5791,.5832,.5869,.5914,.5954,.6003,.6041,.6087,.6126,.6173,.6215,.6263,.6304,.6348,.6383,.6414,.6452,.6494,.6525,.6563,.6604,.6647,.6691,.672,.6752,.6806,.6839,.6879,.6916,.6961,.701,.7046,.7077,.7116,.7164,.7194,.7235,.7288,.7331,.7371,.7412,.7475,.7527,.7562,.761,.7647,.7685,.7722,.7761,.7809,.7852,.7893,.7931,.7961,.799,.8027,.8068,.8099,.8133,.8171,.8213,.8259,.8294,.8336,.8377,.8407,.8441,.8479,.8513,.8546,.858,.8611,.8636,.8679,.8715,.8751,.8782,.8813,.8846,.888,.891,.8943,.8967,.9004,.903,.9054,.9082,.9113,.9142,.9167,.9189,.9213,.9236,.9269,.9291,.9309,.9331,.9362,.9384,.9397,.9418,.944,.9455,.9474,.9489,.9505,.9533,.955,.9564,.9581,.96,.9614,.9626,.9641,.9658,.9679,.9688,.9706,.9718,.9731,.9744,.9757,.9767,.9785,.9796,.9806,.9817,.9827,.9832,.9838,.9846,.9851,.9859,.9864,.9867,.9876,.9885,.9887,.9891,.9898,.9902,.9912,.9913,.9917,.9922,.9928,.9931,.9932,.9932,.9938,.9941,.9943,.9947,.9954,.996,.9961,.9961,.9962,.9965,.9966,.9969,.997,.9972,.9974,.9975,.9976,.998,.998,.9981,.9981,.9986,.9987,.9989,.999,.9992,.9992,.9992,.9994,.9995,.9995,.9996,.9996,.9996,.9996,.9997,.9997,.9997,.9997,.9997,.9998,.9998,.9998,.9999,.9999,.9999,.9999,.9999,.9999,.9999,.9999,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],new T.MapGenerator.Biotope([{amount:120,terrain:A.terrains[1]},{amount:40,terrain:A.terrains[11]},{amount:30,terrain:A.terrains[4]},{amount:20,terrain:A.terrains[12]},{amount:40,terrain:A.terrains[9]},{amount:20,terrain:A.terrains[8]},{amount:20,terrain:A.terrains[10]},{amount:50,terrain:A.terrains[4]},{amount:10,terrain:A.terrains[13]},{amount:20,terrain:A.terrains[5]},{amount:60,terrain:A.terrains[3]},{amount:10,terrain:A.terrains[10]},{amount:60,terrain:A.terrains[7]},{amount:10,terrain:A.terrains[5]}]),function(e,t){"terrain"==e.type&&(5==e.design.data.image?t.push({x:e.x,y:e.y,type:"natural",design:{type:"natural",data:{image:"rock"+Math.floor(6*T.Math.randomSeedPosition(1,{x:e.x,y:e.y}))%6+"dark"+Math.floor(4*T.Math.randomSeedPosition(2,{x:e.x,y:e.y}))%4,size:.5+1*T.Math.randomSeedPosition(5,{x:e.x,y:e.y})}}}):10==e.design.data.image&&t.push({x:e.x,y:e.y,type:"natural",design:{type:"natural",data:{image:"tree"+Math.floor(10*T.Math.randomSeedPosition(3,{x:e.x,y:e.y}))%10,size:1+T.Math.randomSeedPosition(6,{x:e.x,y:e.y})/2}}}))}),T.World=T.World||{};var A=T.World,K=.05;A.game=new T.Game({defense:new T.Game.ActionType("passive",{defense:"number"},function(e){return 800*e.defense*K},T.Resources.newSingles({wood:2,clay:2,stone:1,iron:0})),regenerate:new T.Game.ActionType("passive",{regenerate:"number"},function(e){return 1/e.regenerate*3600*K},T.Resources.newSingles({wood:4,clay:2,stone:2,iron:2})),repair:new T.Game.ActionType("active",{repair:"number"},function(e){return 1/(e.repair/100)*1e3*K},T.Resources.newSingles({wood:4,clay:2,stone:3,iron:4}),function(e,t){}),mine:new T.Game.ActionType("passive",{resource:"string",amount:"number"},function(e){return 3600*e.amount*K},T.Resources.newSingles({wood:3,clay:2,stone:2,iron:4})),attack:new T.Game.ActionType("active",{distance:"number",strength:"number",rounds:"number",cooldown:"number"},function(e){return Math.pow(e.distance,2)*e.strength*e.rounds*(1/e.cooldown)*100*K},T.Resources.newSingles({wood:2,clay:0,stone:3,iron:2}),function(e,t){}),move:new T.Game.ActionType("active",{speed:"number"},function(e){return 10*Math.pow(e.speed,2)*K},T.Resources.newSingles({wood:2,clay:0,stone:0,iron:1}),function(e,t){}),throughput:new T.Game.ActionType("passive",{throughput:"number"},function(e){return 10*Math.pow(e.throughput/100,2)*K},T.Resources.newSingles({wood:2,clay:3,stone:1,iron:0}))},T.Math.prettyNumber,T.Math.prettyNumber);